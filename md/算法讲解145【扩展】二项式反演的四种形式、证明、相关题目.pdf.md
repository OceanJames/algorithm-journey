⼆项式反演的四种形式、证明、相关题⽬

前置知识
讲解066 ~ 讲解069 - 动态规划基础内容，本节课题⽬涉及动态规划
讲解078 ~ 讲解079 - 树型dp，本节课题⽬5需要
讲解118 - 树上问题专题1，递归函数改成迭代函数，防⽌系统栈溢出，本节课题⽬5需要
讲解144 - ⼆项式定理

上节课讲述
⼆项式定理证明和相关题⽬

本节课讲述
⼆项式反演的四种形式、证明、相关题⽬

左程云

⼆项式反演的四种形式、证明、相关题⽬

⼆项式反演的四种形式

课上图解如何使⽤

f(i)、g(i)，可以是数列或者函数

具备反演的特征，就可以互相转化

形式⼆、形式四最常⽤

不需要⽤容斥来理解(徒增烦恼)

本节课会讲解完整的证明(包懂)

左程云

⼆项式反演的四种形式、证明、相关题⽬

题⽬1
信封问题(错排问题)
⼀共n个⼈，每个⼈都写了⼀封信
每个⼈必须寄出⼀封信，每个⼈必须收到⼀封信，并且不能⾃⼰寄给⾃⼰
返回⼀共有多少种寄信的⽅法
1 <= n <= 20
测试链接 : https://www.luogu.com.cn/problem/P1595

左程云

⼆项式反演的四种形式、证明、相关题⽬

左程云

⼆项式反演的四种形式、证明、相关题⽬

左程云

⼆项式反演的四种形式、证明、相关题⽬

左程云

⼆项式反演的四种形式、证明、相关题⽬

左程云

⼆项式反演的四种形式、证明、相关题⽬

左程云

⼆项式反演的四种形式、证明、相关题⽬

题⽬2
集合计数
⼀共有n个不同的数，能构成2^n个不同集合
在2^n个集合中挑出若⼲个集合，⾄少挑⼀个
希望这若⼲个集合的交集，正好有k个数
返回挑选集合的⽅案数，答案对 1000000007 取余
1 <= n <= 10^6
0 <= k <= n
测试链接 : https://www.luogu.com.cn/problem/P10596

⼆项式反演形式四

(钦定k个且⾄少 -> 恰好k个)的转化

左程云

⼆项式反演的四种形式、证明、相关题⽬

题⽬3
分特产
⼀共有m种特产，arr[i]表示i种特产有⼏个，同⼀种特产的物品之间⽆差别
⼀共有n个同学，同学之间认为有差别，每个同学⾄少要得到⼀个特产
返回分配特产的⽅法数，答案对 1000000007 取余
0 <= n、m <= 1000
0 <= arr[i] <= 1000
测试链接 : https://www.luogu.com.cn/problem/P5505

强烈建议先看懂题⽬2
⼆项式反演形式四
(钦定k个且⾄少 -> 恰好k个)的转化
隔板法分析m个相同物品分给n个⼈的⽅法数

左程云

⼆项式反演的四种形式、证明、相关题⽬

题⽬4
已经没有什么好害怕的了
给定两个⻓度为n的数组，a[i]表示第i个糖果的能量，b[i]表示第i个药⽚的能量
所有能量数值都不相同，每⼀个糖果要选⼀个药⽚进⾏配对
如果配对之后，糖果能量 > 药⽚能量，称为糖果⼤的配对
如果配对之后，糖果能量 < 药⽚能量，称为药⽚⼤的配对
希望做到，糖果⼤的配对数量 = 药⽚⼤的配对数量 + k，返回配对⽅法数，答案对 1000000009 取余
举例，a = [5, 35, 15, 45]，b = [40, 20, 10, 30]，k = 2，返回4，因为有4种配对⽅法
(5-40，35-20，15-10，45-30)、(5-40，35-30，15-10，45-20)
(5-20，35-30，15-10，45-40)、(5-30，35-20，15-10，45-40)
1 <= n <= 2000    0 <= k <= n
测试链接 : https://www.luogu.com.cn/problem/P4859

⼆项式反演形式四 + (钦定k个且⾄少 -> 恰好k个)的转化 + 背包dp

左程云

⼆项式反演的四种形式、证明、相关题⽬

题⽬5
游戏
⼀共有n个节点，n <= 5000，n为偶数，其中有m个点属于⼩A，有m个点属于⼩B，m为n的⼀半
给定n-1条边，节点之间组成⼀颗树，1号节点是根节点
给定⻓度为n的数组arr，arr[i]的值表示i号节点由谁拥有，0为⼩A拥有，1为⼩B拥有
游戏有m回合，每回合都有胜负，两⼈需要选择⼀个⾃⼰拥有、但之前没选过的点，作为本回合当前点
⼩A当前点的⼦树⾥有⼩B当前点，则⼩A胜；⼩B当前点的⼦树⾥有⼩A当前点，则⼩B胜；否则平局
返回m回合⾥能出现k次⾮平局的游戏⽅法数，打印k=0..m时的所有答案，对 998244353 取余
两场游戏视为不同的定义：当且仅当存在⼩A拥有的点x，⼩B在⼩A选择x的那个回合所选择的点不同
测试链接 : https://www.luogu.com.cn/problem/P6478

⼆项式反演形式四 + (钦定k个且⾄少 -> 恰好k个)的转化

树型dp + 树型dp的枚举⾏为利⽤⼦树的节点数做上限进⾏复杂度优化 + 递归函数改成迭代函数

左程云

