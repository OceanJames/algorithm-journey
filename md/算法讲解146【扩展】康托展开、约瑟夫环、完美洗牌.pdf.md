康托展开、约瑟夫环、完美洗牌

前置知识
讲解024 - 随机选择算法，本节课题⽬6需要
讲解108 - 树状数组，理解康托展开需要
讲解110 - 线段树，理解逆康托展开需要

本节课讲述
康托展开（题⽬1）
逆康托展开（题⽬2）
约瑟夫环问题（题⽬3、题⽬4）
完美洗牌算法（题⽬5、题⽬6）

左程云

康托展开、约瑟夫环、完美洗牌

题⽬1
康托展开
数字从1到n，可以有很多排列，给出具体的⼀个排列，求该排列的名次，答案对 998244353 取模
1 <= n <= 10^6
测试链接 : https://www.luogu.com.cn/problem/P5367

注意排名从0开始，不从1开始

利⽤树状数组即可做到时间复杂度最优O(n * log n)，当然⽤线段树也可以，但是常数时间稍⼤

课上重点图解

左程云

康托展开、约瑟夫环、完美洗牌

题⽬2
逆康托展开
数字从1到n，可以有很多排列，给定⼀个⻓度为n的数组s，表示具体的⼀个排列
求出这个排列的排名假设为x，打印第x+m名的排列是什么
1 <= n <= 10^5
1 <= m <= 10^15
题⽬保证s是⼀个由1~n数字组成的正确排列，题⽬保证x+m不会超过排列的总数
测试链接 : https://www.luogu.com.cn/problem/U72177

依然利⽤康托展开公式，但实际过程中排名往往⽐较⼤，⼜不能取余，所以需要⽤阶乘进制来表示排名
排名⽤阶乘进制来表示，然后根据阶乘进制每⼀位状态，可以求出排列的每⼀位字符，这就是逆康托展开
这个过程利⽤线段树才能做到时间复杂度最优O(n * log n)，不推荐树状数组

课上重点图解

左程云

康托展开、约瑟夫环、完美洗牌

题⽬3
约瑟夫环问题
⼀共有1~n这些点，组成⾸尾相接的环
从1号点从数字1开始报数，哪个节点报到数字k，就删除该节点
然后下⼀个节点从数字1开始重新报数，最终环上会剩下⼀个节点
返回该节点的编号
1 <= n, k <= 10^6
测试链接 : https://www.luogu.com.cn/problem/P8671

环的⼤⼩⽤c表示，c = 1时，ans = 1，利⽤如下公式依次计算ans，当c = n时，ans就是答案

ans = (ans + k - 1) % c + 1

课上重点图解

左程云

康托展开、约瑟夫环、完美洗牌

题⽬4
约瑟夫环问题加强
⼀共有1~n这些点，组成⾸尾相接的环，游戏⼀共有n-1轮，每轮给定⼀个数字arr[i]
第⼀轮游戏中，1号点从数字1开始报数，哪个节点报到数字arr[1]，就删除该节点
然后下⼀个节点从数字1开始重新报数，游戏进⼊第⼆轮
第i轮游戏中，哪个节点报到数字arr[i]，就删除该节点
然后下⼀个节点从数字1开始重新报数，游戏进⼊第i+1轮
最终环上会剩下⼀个节点, 返回该节点的编号
1 <= n, arr[i] <= 10^6
来⾃真实⼤⼚笔试，对数器验证

左程云

康托展开、约瑟夫环、完美洗牌

题⽬5
完美洗牌算法
给定数组arr，给定某个范围arr[l..r]，该范围⻓度为n，n是偶数
因为n是偶数，所以范围可以分成左右两部分，arr[l1, l2, ..lk, r1, r2, ..rk]，k = n / 2
请把arr[l..r]范围上的数字调整成arr[r1, l1, r2, l2, .. rk, lk]，其他数字不变
要求时间复杂度O(n)，额外空间复杂度O(1)，对数器验证

1，左右部分交换的原地调整实现
2，下标编号的变化分析 + 下标循环怼的基本思路
3，⼀些特殊⻓度，可以利⽤⼀个数学结论，就能找到所有⼦环的起点，分批进⾏下标循环怼
4，这些特殊⻓度，类似某种进制，任意偶数⻓度都可以从⼤到⼩拆分成特殊⻓度，使问题得到解决
5，时间复杂度和空间复杂度分析

课上重点图解

左程云

康托展开、约瑟夫环、完美洗牌

题⽬6
摇摆排序ii(满⾜全部进阶要求)
给定⼀个数组arr，重新排列数组，确保满⾜：arr[0] < arr[1] > arr[2] < arr[3] > ...
题⽬保证输⼊的数组⼀定有解，要求时间复杂度O(n)，额外空间复杂度O(1)
测试链接 : https://leetcode.cn/problems/wiggle-sort-ii/

满⾜全部进阶要求的做法：

随机选择算法 + 完美洗牌算法 + 题⽬分析

左程云

